(function(){"use strict";var e={6776:function(e,s,t){var o=t(9242),a=t(3396);function n(e,s,t,o,n,r){const l=(0,a.up)("NavBar"),c=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(l),((0,a.wg)(),(0,a.j4)(c,{key:e.$route.fullPath}))],64)}t(8052);var r=t(7139);const l={class:"navbar navbar-expand-lg bg-light"},c={class:"container"},u=(0,a._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,a._)("span",{class:"navbar-toggler-icon"})],-1),i={class:"collapse navbar-collapse",id:"navbarText"},p={class:"navbar-nav me-auto mb-2 mb-lg-0"},d={class:"nav-item"},m={class:"nav-item"},f={key:0,class:"navbar-nav"},v={class:"nav-item"},w={class:"nav-item"},g={key:1,class:"navbar-nav"},_={class:"nav-item"},b={class:"nav-item"};function y(e,s,t,o,n,y){const h=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("nav",l,[(0,a._)("div",c,[(0,a.Wm)(h,{class:"navbar-brand",to:{name:"home"}},{default:(0,a.w5)((()=>[(0,a.Uk)("My Space")])),_:1}),u,(0,a._)("div",i,[(0,a._)("ul",p,[(0,a._)("li",d,[(0,a.Wm)(h,{class:"nav-link",to:{name:"home"}},{default:(0,a.w5)((()=>[(0,a.Uk)("首页")])),_:1})]),(0,a._)("li",m,[(0,a.Wm)(h,{class:"nav-link",to:{name:"userlist"}},{default:(0,a.w5)((()=>[(0,a.Uk)("好友列表")])),_:1})])]),e.$store.state.user.isLogin?((0,a.wg)(),(0,a.iD)("ul",g,[(0,a._)("li",_,[(0,a.Wm)(h,{class:"nav-link",to:{name:"userprofile",params:{userId:e.$store.state.user.id}}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.$store.state.user.username),1)])),_:1},8,["to"])]),(0,a._)("li",b,[(0,a._)("a",{class:"nav-link",style:{cursor:"pointer"},onClick:s[0]||(s[0]=(...e)=>o.logout&&o.logout(...e))},"退出")])])):((0,a.wg)(),(0,a.iD)("ul",f,[(0,a._)("li",v,[(0,a.Wm)(h,{class:"nav-link",to:{name:"login"}},{default:(0,a.w5)((()=>[(0,a.Uk)("登录")])),_:1})]),(0,a._)("li",w,[(0,a.Wm)(h,{class:"nav-link",to:{name:"register"}},{default:(0,a.w5)((()=>[(0,a.Uk)("注册")])),_:1})])]))])])])}var h=t(65),k={name:"NavBar",setup(){const e=(0,h.oR)(),s=()=>{e.commit("logout")};return{logout:s}}},P=t(89);const C=(0,P.Z)(k,[["render",y]]);var j=C,U={name:"App",components:{NavBar:j}};const B=(0,P.Z)(U,[["render",n]]);var O=B,x=t(2483);function D(e,s,t,o,n,r){const l=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" 首页 ")])),_:1})}const T={class:"home"},I={class:"container"},S={class:"card"},z={class:"card-body"};function M(e,s,t,o,n,r){return(0,a.wg)(),(0,a.iD)("div",T,[(0,a._)("div",I,[(0,a._)("div",S,[(0,a._)("div",z,[(0,a.WI)(e.$slots,"default",{},void 0,!0)])])])])}var F={name:"ContentBase"};const H=(0,P.Z)(F,[["render",M],["__scopeId","data-v-7d1329f9"]]);var W=H,Z={name:"HomeView",components:{ContentBase:W}};const A=(0,P.Z)(Z,[["render",D]]);var L=A;const V=["onClick"],q={class:"card-body"},R={class:"row"},E={class:"col-1 img-field"},$=["src"],N={class:"col-11"},G={class:"username"},Y={class:"follower-count"};function K(e,s,t,o,n,l){const c=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(c,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.users,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"card",key:e.id,onClick:s=>o.openUserProfile(e.id)},[(0,a._)("div",q,[(0,a._)("div",R,[(0,a._)("div",E,[(0,a._)("img",{class:"img-fluid",src:e.photo,alt:""},null,8,$)]),(0,a._)("div",N,[(0,a._)("div",G,(0,r.zw)(e.username),1),(0,a._)("div",Y,(0,r.zw)(e.followerCount),1)])])])],8,V)))),128))])),_:1})}t(7658);var J=t(7387),Q=t.n(J),X=t(4870),ee={name:"UserList",components:{ContentBase:W},setup(){const e=(0,h.oR)();let s=(0,X.iH)([]);Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/userlist/",type:"get",success(e){s.value=e}});const t=s=>{e.state.user.isLogin?bs.push({name:"userprofile",params:{userId:s}}):bs.push({name:"login"})};return{users:s,openUserProfile:t}}};const se=(0,P.Z)(ee,[["render",K],["__scopeId","data-v-21304872"]]);var te=se;const oe={class:"row"},ae={class:"col-3"},ne={class:"col-9"};function re(e,s,t,o,n,r){const l=(0,a.up)("UserProfileInfo"),c=(0,a.up)("UserProfileWrite"),u=(0,a.up)("UserProfilePosts"),i=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(i,null,{default:(0,a.w5)((()=>[(0,a._)("div",oe,[(0,a._)("div",ae,[(0,a.Wm)(l,{onFollow:e.follow,onUnfollow:e.unfollow,user:e.user},null,8,["onFollow","onUnfollow","user"]),e.isMe?((0,a.wg)(),(0,a.j4)(c,{key:0,onSubmitPost:e.submitPost},null,8,["onSubmitPost"])):(0,a.kq)("",!0)]),(0,a._)("div",ne,[(0,a.Wm)(u,{user:e.user,posts:e.posts,onDeletePost:e.deletePost},null,8,["user","posts","onDeletePost"])])])])),_:1})}t(541);const le={class:"card"},ce={class:"card-body"},ue={class:"row"},ie={class:"col-3"},pe=["src"],de={class:"col-9"},me={class:"username"},fe={class:"fans"};function ve(e,s,t,o,n,l){return(0,a.wg)(),(0,a.iD)("div",le,[(0,a._)("div",ce,[(0,a._)("div",ue,[(0,a._)("div",ie,[(0,a._)("img",{src:t.user.photo,class:"img-fluid",alt:""},null,8,pe)]),(0,a._)("div",de,[(0,a._)("div",me,(0,r.zw)(t.user.username),1),(0,a._)("div",fe,"粉丝："+(0,r.zw)(t.user.followerCount),1),t.user.isFollowed?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:s[0]||(s[0]=(...e)=>o.follow&&o.follow(...e)),type:"button",class:"btn btn-primary btn sm"},"+关注")),t.user.isFollowed?((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:s[1]||(s[1]=(...e)=>o.unfollow&&o.unfollow(...e)),type:"button",class:"btn btn-secondary btn sm"},"取消关注")):(0,a.kq)("",!0)])])])])}var we={name:"UserProfileInfo",props:{user:{type:Object,required:!0}},setup(e,s){const t=(0,h.oR)(),o=()=>{Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+t.state.user.access},success(e){"success"===e.result&&s.emit("follow")}})},a=()=>{Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+t.state.user.access},success(e){"success"===e.result&&s.emit("unfollow")}})};return{follow:o,unfollow:a}}};const ge=(0,P.Z)(we,[["render",ve],["__scopeId","data-v-4d856e08"]]);var _e=ge;const be={class:"card"},ye={class:"card-body"},he={class:"card single-post"},ke={class:"card-body"},Pe=["onClick"];function Ce(e,s,t,o,n,l){return(0,a.wg)(),(0,a.iD)("div",be,[(0,a._)("div",ye,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.posts.posts,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",he,[(0,a._)("div",ke,[(0,a.Uk)((0,r.zw)(e.content)+" ",1),o.isMe?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:s=>o.deletePost(e.id),class:"btn btn-danger btn-sm"}," 删除 ",8,Pe)):(0,a.kq)("",!0)])])])))),128))])])}var je={name:"UserProfilePosts",props:{posts:{type:Object,required:!0},user:{type:Object,required:!0}},setup(e,s){const t=(0,h.oR)();let o=(0,a.Fl)((()=>t.state.user.id===e.user.id));const n=e=>{Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"DELETE",data:{post_id:e},headers:{Authorization:"Bearer "+t.state.user.access},success(t){"success"===t.result&&s.emit("deletePost",e)}})};return{deletePost:n,isMe:o}}};const Ue=(0,P.Z)(je,[["render",Ce],["__scopeId","data-v-411a01cc"]]);var Be=Ue;const Oe=e=>((0,a.dD)("data-v-6fe7d450"),e=e(),(0,a.Cn)(),e),xe={class:"card edit-field"},De={class:"card-body"},Te=Oe((()=>(0,a._)("label",{for:"edit-post",class:"form-label"},"编辑帖子",-1)));function Ie(e,s,t,n,r,l){return(0,a.wg)(),(0,a.iD)("div",xe,[(0,a._)("div",De,[Te,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.content=e),class:"form-control",id:"edit-post",rows:"3"},null,512),[[o.nr,n.content]]),(0,a._)("button",{onClick:s[1]||(s[1]=(...e)=>n.submitPost&&n.submitPost(...e)),type:"button",class:"btn btn-primary btn-sm"},"发帖")])])}var Se={name:"UserProfileWrite",setup(e,s){const t=(0,h.oR)();let o=(0,X.iH)("");const a=()=>{Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"POST",data:{content:o.value},headers:{Authorization:"Bearer "+t.state.user.access},success(e){"success"===e.result&&(s.emit("submitPost",o.value),o.value="")}})};return{content:o,submitPost:a}}};const ze=(0,P.Z)(Se,[["render",Ie],["__scopeId","data-v-6fe7d450"]]);var Me=ze,Fe={name:"UserProfile",components:{ContentBase:W,UserProfileInfo:_e,UserProfilePosts:Be,UserProfileWrite:Me},setup:()=>{const e=(0,h.oR)(),s=(0,x.yj)(),t=s.params.userId,o=(0,X.qj)({}),n=(0,X.qj)({});Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:t},headers:{Authorization:"Bearer "+e.state.user.access},success(e){o.id=e.id,o.username=e.username,o.photo=e.photo,o.followerCount=e.followerCount,o.isFollowed=e.is_followed}}),Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"GET",data:{user_id:t},headers:{Authorization:"Bearer "+e.state.user.access},success(e){n.count=e.length,n.posts=e}});const r=()=>{o.isFollowed||(o.isFollowed=!0,o.followerCount++)},l=()=>{o.isFollowed&&(o.isFollowed=!1,o.followerCount--)},c=e=>{n.count++,n.posts.unshift({id:n.count,userId:1,content:e})},u=e=>{n.posts=n.posts.filter((s=>s.id!==e)),n.count=n.posts.length},i=(0,a.Fl)((()=>t==e.state.user.id));return{user:o,follow:r,unfollow:l,posts:n,submitPost:c,deletePost:u,userId:t,isMe:i}}};const He=(0,P.Z)(Fe,[["render",re]]);var We=He;const Ze=e=>((0,a.dD)("data-v-17352836"),e=e(),(0,a.Cn)(),e),Ae={class:"row justify-content-md-center"},Le={class:"col-3"},Ve={class:"mb-3"},qe=Ze((()=>(0,a._)("label",{for:"username",class:"form-label"},"用户名",-1))),Re={class:"mb-3"},Ee=Ze((()=>(0,a._)("label",{for:"password",class:"form-label"},"密码",-1))),$e={class:"error-message"},Ne=Ze((()=>(0,a._)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function Ge(e,s,t,n,l,c){const u=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",Ae,[(0,a._)("div",Le,[(0,a._)("form",{onSubmit:s[2]||(s[2]=(0,o.iM)(((...e)=>n.login&&n.login(...e)),["prevent"]))},[(0,a._)("div",Ve,[qe,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"username",class:"form-control",id:"username"},null,512),[[o.nr,n.username]])]),(0,a._)("div",Re,[Ee,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[o.nr,n.password]])]),(0,a._)("div",$e,(0,r.zw)(n.errorMessage),1),Ne],32)])])])),_:1})}var Ye={name:"LoginView",components:{ContentBase:W},setup(){const e=(0,h.oR)();let s=(0,X.iH)(""),t=(0,X.iH)(""),o=(0,X.iH)("");const a=()=>{o.value="",e.dispatch("login",{username:s.value,password:t.value,success(){bs.push({name:"userlist"})},error(){o.value="用户名或密码错误"}})};return{username:s,password:t,errorMessage:o,login:a}}};const Ke=(0,P.Z)(Ye,[["render",Ge],["__scopeId","data-v-17352836"]]);var Je=Ke;const Qe=e=>((0,a.dD)("data-v-755a8de2"),e=e(),(0,a.Cn)(),e),Xe={class:"row justify-content-md-center"},es={class:"col-3"},ss={class:"mb-3"},ts=Qe((()=>(0,a._)("label",{for:"username",class:"form-label"},"用户名",-1))),os={class:"mb-3"},as=Qe((()=>(0,a._)("label",{for:"password",class:"form-label"},"密码",-1))),ns={class:"mb-3"},rs=Qe((()=>(0,a._)("label",{for:"passwordConfirm",class:"form-label"},"确认密码",-1))),ls={class:"error-message"},cs=Qe((()=>(0,a._)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function us(e,s,t,n,l,c){const u=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",Xe,[(0,a._)("div",es,[(0,a._)("form",{onSubmit:s[3]||(s[3]=(0,o.iM)(((...e)=>n.register&&n.register(...e)),["prevent"]))},[(0,a._)("div",ss,[ts,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"username",class:"form-control",id:"username"},null,512),[[o.nr,n.username]])]),(0,a._)("div",os,[as,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[o.nr,n.password]])]),(0,a._)("div",ns,[rs,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.passwordConfirm=e),type:"password",class:"form-control",id:"passwordConfirm"},null,512),[[o.nr,n.passwordConfirm]])]),(0,a._)("div",ls,(0,r.zw)(n.errorMessage),1),cs],32)])])])),_:1})}var is={name:"RegisterView",components:{ContentBase:W},setup(){const e=(0,h.oR)();let s=(0,X.iH)(""),t=(0,X.iH)(""),o=(0,X.iH)(""),a=(0,X.iH)("");const n=()=>{a.value="",Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/user/",type:"POST",data:{username:s.value,password:t.value,password_confirm:o.value},success(o){"success"===o.result?e.dispatch("login",{username:s.value,password:t.value,success(){bs.push({name:"userlist"})},error(){a.value="系统异常，请稍后重试"}}):a.value=o.result}})};return{username:s,password:t,errorMessage:a,register:n,passwordConfirm:o}}};const ps=(0,P.Z)(is,[["render",us],["__scopeId","data-v-755a8de2"]]);var ds=ps;function ms(e,s,t,o,n,r){const l=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" 404 ")])),_:1})}var fs={name:"NotFoundView",components:{ContentBase:W}};const vs=(0,P.Z)(fs,[["render",ms]]);var ws=vs;const gs=[{path:"/myspace/",name:"home",component:L},{path:"/myspace/userlist/",name:"userlist",component:te},{path:"/myspace/userprofile/:userId/",name:"userprofile",component:We},{path:"/myspace/login/",name:"login",component:Je},{path:"/myspace/register/",name:"register",component:ds},{path:"/myspace/404/",name:"404",component:ws},{path:"/myspace/:catchAll(.*)",redirect:"/myspace/404/"}],_s=(0,x.p7)({history:(0,x.PO)(),routes:gs});var bs=_s,ys=t(1598);const hs={state:{username:"",id:"",photo:"",followerCount:0,access:"",refresh:"",isLogin:!1},getters:{},mutations:{updateUser(e,s){e.id=s.id,e.username=s.username,e.photo=s.photo,e.followerCount=s.followerCount,e.access=s.access,e.isLogin=s.isLogin},updateAccess(e,s){e.access=s},logout(e){e.id="",e.username="",e.photo="",e.followerCount=0,e.access="",e.refresh="",e.isLogin=!1}},actions:{login:(e,s)=>{Q().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/",type:"POST",data:{username:s.username,password:s.password},success(t){const{access:o,refresh:a}=t,n=(0,ys.Z)(o);setInterval((()=>{Q().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/refresh/",type:"POST",data:{refresh:a},success(s){e.commit("updateAccess",s.access)}})}),27e4),Q().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:n.user_id},headers:{Authorization:"Bearer "+o},success(t){e.commit("updateUser",{...t,access:o,refresh:a,isLogin:!0}),s.success()}})},error(){s.error()}})}},modules:{}};var ks=hs,Ps=(0,h.MT)({state:{},getters:{},mutations:{},actions:{},modules:{user:ks}});(0,o.ri)(O).use(Ps).use(bs).mount("#app")}},s={};function t(o){var a=s[o];if(void 0!==a)return a.exports;var n=s[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,o,a,n){if(!o){var r=1/0;for(i=0;i<e.length;i++){o=e[i][0],a=e[i][1],n=e[i][2];for(var l=!0,c=0;c<o.length;c++)(!1&n||r>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[c])}))?o.splice(c--,1):(l=!1,n<r&&(r=n));if(l){e.splice(i--,1);var u=a();void 0!==u&&(s=u)}}return s}n=n||0;for(var i=e.length;i>0&&e[i-1][2]>n;i--)e[i]=e[i-1];e[i]=[o,a,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var o in s)t.o(s,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:s[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,o){var a,n,r=o[0],l=o[1],c=o[2],u=0;if(r.some((function(s){return 0!==e[s]}))){for(a in l)t.o(l,a)&&(t.m[a]=l[a]);if(c)var i=c(t)}for(s&&s(o);u<r.length;u++)n=r[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(i)},o=self["webpackChunkvue_learning"]=self["webpackChunkvue_learning"]||[];o.forEach(s.bind(null,0)),o.push=s.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(6776)}));o=t.O(o)})();
//# sourceMappingURL=app.7ec7a378.js.map